---
title: "EJ_Data_Exploration"
author: "Mario"
date: "7/2/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
#library load
#install.packages("tidyverse")
#install.packages("sf")
library(tidyverse)
library(sf)


```


```{r}


#read calenvironscreen csv which is organized by GeoID

cal_environ_screen <- read.csv("CalEnvironScreen/ces3results.csv")
#View(cal_environ_screen)

names(cal_environ_screen)

#read in race data based on 2010 census tract which is organized by Geocode (geoID2)

race_census <- read.csv("censusTract_race/DEC_10_SF1_QTP3_with_ann.csv")

#https://walkerke.github.io/tidycensus/articles/spatial-data.html

#look at mismatched geoIDs between two datasets

a <- as.vector(cal_environ_screen$Census.Tract)

b <- as.vector(race_census$GeoID2)

b[!(b %in% a)]

#remove mismatced from race_census dataset

# 6001990000, 6013990000 6015990000 6017990000 6023990100 6037990100 6037990200 6037990300
# 6041990100 6045990100 6053990000 6059990100 6061990000 6073990100 6075980401 6075990100
# 6079990000 6081990100 6083990000 6087990100 6097990100 6111990100

```




```{r}

#Subset Race Data to ONLY include GeoID2, Total population, Race Specific Raw and Percent 

race_minimal <- race_census %>% 
  select("GeoID2", "Number..RACE...Total.population", "Percent..RACE...Total.population", "Number..RACE...Total.population...One.race...White",	"Percent..RACE...Total.population...One.race...White",	"Number..RACE...Total.population...One.race...Black.or.African.American",	"Percent..RACE...Total.population...One.race...Black.or.African.American",	"Number..RACE...Total.population...One.race...American.Indian.and.Alaska.Native","Percent..RACE...Total.population...One.race...American.Indian.and.Alaska.Native","Number..RACE...Total.population...One.race...Asian",	"Percent..RACE...Total.population...One.race...Asian","Number..RACE...Total.population...One.race...Native.Hawaiian.and.Other.Pacific.Islander",	"Percent..RACE...Total.population...One.race...Native.Hawaiian.and.Other.Pacific.Islander", "Number..HISPANIC.OR.LATINO...Total.population...Hispanic.or.Latino..of.any.race.", "Percent..HISPANIC.OR.LATINO...Total.population...Hispanic.or.Latino..of.any.race.") %>% 
  filter(!GeoID2 %in% c(6001990000, 6013990000, 6015990000, 6017990000, 6023990100, 6037990100, 6037990200, 6037990300, 6041990100, 6045990100, 6053990000, 6059990100, 6061990000, 6073990100, 6075980401, 6075990100, 6079990000, 6081990100, 6083990000, 6087990100, 6097990100, 6111990100))

#rename columns (rename "GeoID2" "Census.Tract" to match CalEnvironScreen)
rename <- c("Census.Tract", "Number_Total", "Percent_Total", "Number_White", "Percent_White", "Number_Black", "Percent_Black", "Number_AmericanIndian_AlaskaNative", "Percent_AmericanIndian_AlaksaNative", "Number_Asian", "Percent_Asian", "Number_Hawaiian_PacificIslander", "Percent_Hawaiian_PacificIslander", "Number_Hispanic_Latinx", "Percent_Hispanic_Latinx")

names(race_minimal) <- rename

#merge two dataframes for complete CalEnvironScreen (ces) and Census Tract Demograohics (demo)

ces_demo <- merge(cal_environ_screen, race_minimal, by = "Census.Tract")

head(ces_demo)

```




```{r}

#read in csv files

ces_demo_space <- st_as_sf(ces_demo, coords = c("Longitude", "Latitude"), crs = 4326)

#get CA census tract visual 

ca_census <- st_read("tl_2016_06_tract/tl_2016_06_tract.shp")

ca_census_only <- ca_census %>% 
  select(GEOID)


ggplot()+
  geom_sf(data = ca_census_only, fill = "gray40") +
  geom_sf(data = ces_demo_space, aes(color = "CES.3.0.Percentile"), size = 0.5)


```


```{r}

#read in well csv to see data 

well_location_table <- read.csv("Well_Data/AllWells_table/AllWells_20190724.csv")

#see status of all wells 

unique(well_location_table$WellStatus)

#read in and display well fracking data 

well_location_spatial <- st_read("Well_Data/AllWells_spatial/Wells_All.shp")
head(well_location)

ggplot()+
  geom_sf(data = ca_census_only, fill = "gray40") +
  geom_sf(data = well_location, aes(color = "API"), size = 0.5)

```

